upstream grpc_server {
    server storageusers1:9157;
    server storageusers2:9157;  
}

upstream http_server {
    server storageusers1:9158;
    server storageusers2:9158;  
}

server {
    listen 9157;
    http2 on; # Enable HTTP/2 for gRPC

    location / {
        grpc_pass grpc://grpc_server;
    }
}

server {
    listen 9158;

    location / {
        proxy_pass http://http_server;
    }
}

server {
    listen 80;

    location / {
        add_header Content-Type text/plain;
        return 200 "Nginx is ready to serve";
    }
}
